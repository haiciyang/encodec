/home/anakuzne/miniconda3/envs/encodec/lib/python3.11/site-packages/torchaudio/functional/functional.py:576: UserWarning: At least one mel filterbank has all zero values. The value for `n_mels` (64) may be set too high. Or, the value for `n_freqs` (17) may be set too low.
  warnings.warn(
/home/anakuzne/miniconda3/envs/encodec/lib/python3.11/site-packages/torchaudio/functional/functional.py:576: UserWarning: At least one mel filterbank has all zero values. The value for `n_mels` (64) may be set too high. Or, the value for `n_freqs` (33) may be set too low.
  warnings.warn(
/home/anakuzne/miniconda3/envs/encodec/lib/python3.11/site-packages/torchaudio/functional/functional.py:576: UserWarning: At least one mel filterbank has all zero values. The value for `n_mels` (64) may be set too high. Or, the value for `n_freqs` (65) may be set too low.
  warnings.warn(
/home/anakuzne/miniconda3/envs/encodec/lib/python3.11/site-packages/torchaudio/functional/functional.py:576: UserWarning: At least one mel filterbank has all zero values. The value for `n_mels` (64) may be set too high. Or, the value for `n_freqs` (129) may be set too low.
  warnings.warn(
[Step]: 0 | [Train losses]: {'l_g': tensor(0.1001), 'l_d': tensor(0.3114), 'l_t': tensor(119.6683), 'l_f': tensor(41.6713), 'l_w': tensor(73577752.), 'l_feat': tensor(0.0994), 'tr_entropy': tensor(163.6078)}
[Step]: 0 | [Valid losses]: {'val_l_t': tensor(1075.2268), 'sdr_tt': tensor(1.8783), 'val_entropy': tensor(1636.0782)}
[Step]: 10 | [Train losses]: {'l_g': tensor(0.9729), 'l_d': tensor(3.0458), 'l_t': tensor(636.5592), 'l_f': tensor(59.4943), 'l_w': tensor(73174384.), 'l_feat': tensor(0.7045), 'tr_entropy': tensor(1636.0782)}
[Step]: 10 | [Valid losses]: {'val_l_t': tensor(887.5707), 'sdr_tt': tensor(3.5158), 'val_entropy': tensor(1636.0782)}
[Step]: 20 | [Train losses]: {'l_g': tensor(0.9996), 'l_d': tensor(2.2008), 'l_t': tensor(548.1118), 'l_f': tensor(42.0909), 'l_w': tensor(15683040.), 'l_feat': tensor(0.6803), 'tr_entropy': tensor(1636.0782)}
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/anakuzne/projects/encodec_hy/encodec/code/encodec/dist_train.py", line 502, in <module>
    val_losses = valid(model, valid_loader, inp_args.bandwidth, gpu_rank, inp_args.use_se_loss, inp_args.debug)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/anakuzne/projects/encodec_hy/encodec/code/encodec/dist_train.py", line 292, in valid
    batch_entropy = entropy_rate(qtz_emb)
                    ^^^^^^^^^^^^^^^^^^^^^
  File "/home/anakuzne/projects/encodec_hy/encodec/code/encodec/dist_train.py", line 101, in entropy_rate
    e = torch.sum(n*torch.log2(n))
                    ^^^^^^^^^^^^^
KeyboardInterrupt